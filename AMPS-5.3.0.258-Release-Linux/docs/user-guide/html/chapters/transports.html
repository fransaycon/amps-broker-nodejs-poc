<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>18. Transports &#8212; AMPS User Guide 5.3.0.255
 documentation</title>
    
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '5.3.0.255',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="19. Running AMPS as a Linux Service" href="daemon.html" />
    <link rel="prev" title="17. Command Acknowledgment" href="acks.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/flag_logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">18. Transports</a><ul>
<li><a class="reference internal" href="#client-connections">Client connections</a><ul>
<li><a class="reference internal" href="#tcp-connections">TCP Connections</a></li>
<li><a class="reference internal" href="#ssl-connections">SSL Connections</a></li>
<li><a class="reference internal" href="#unix-domain-sockets">Unix domain sockets</a></li>
</ul>
</li>
<li><a class="reference internal" href="#replication-connections">Replication Connections</a></li>
<li><a class="reference internal" href="#transport-filters">Transport Filters</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="acks.html" title="previous chapter">17. Command Acknowledgment</a></li>
      <li>Next: <a href="daemon.html" title="next chapter">19. Running AMPS as a Linux Service</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="transports">
<span id="ug-transports"></span><span id="index-0"></span><h1>18. Transports<a class="headerlink" href="#transports" title="Permalink to this headline">¶</a></h1>
<p>In order to send and receive messages, an AMPS server must allow
incoming connections. <em>Transports</em> configure incoming
connections to AMPS. Transports are configured in the <code class="docutils literal"><span class="pre">Transports</span></code>
element of the AMPS configuration file.</p>
<p>AMPS provides two distinct kinds of incoming connections:</p>
<ul class="simple">
<li><em>Client connections</em>, for use by the AMPS clients to support external
applications</li>
<li><em>Replication connections</em>, to replicate to other AMPS instances</li>
</ul>
<p>Each transport controls how authentication and entitlements are enforced
for that transport. The transport can either accept the defaults for the
instance as a whole, or choose settings unique to that transport.</p>
<div class="section" id="client-connections">
<h2>Client connections<a class="headerlink" href="#client-connections" title="Permalink to this headline">¶</a></h2>
<p>To accept connections from publishers or subscribers, an AMPS instance
must have at least one <code class="docutils literal"><span class="pre">Transport</span></code> configured for client connections.
The transport must specify:</p>
<ul class="simple">
<li>The network protocol used for the transport, called the transport
<em>type</em></li>
<li>The AMPS command header format, called the <em>protocol</em></li>
<li>The network address, such as IP address and port, that the AMPS
server will listen to for incoming connections</li>
</ul>
<p>A transport can <em>optionally</em> set other parameters on the transport. This
includes setting the authentication and entitlements that apply to
connections for this transport, setting slow client parameters for the
transport, and so forth.</p>
<div class="section" id="tcp-connections">
<h3>TCP Connections<a class="headerlink" href="#tcp-connections" title="Permalink to this headline">¶</a></h3>
<p>This is the most commonly used connection type for AMPS clients.</p>
<p>With this option, communication occurs over a standard TCP/IP
connection.</p>
</div>
<div class="section" id="ssl-connections">
<h3>SSL Connections<a class="headerlink" href="#ssl-connections" title="Permalink to this headline">¶</a></h3>
<p>AMPS supports SSL connections between clients and servers. To enable SSL
on a transport, you must:</p>
<ul class="simple">
<li>Specify a Transport type of <code class="docutils literal"><span class="pre">tcp</span></code> or <code class="docutils literal"><span class="pre">tcps</span></code>, <em>and</em></li>
<li>Provide a certificate and private key for the connection</li>
</ul>
<p>You can optionally set other parameters for SSL connections, as
described in the <a class="reference external" href="../../../configuration/html/index.html">AMPS Configuration Reference</a>.</p>
<table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="86%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><img alt="caution" src="../_images/caution.svg" /></td>
<td><p class="first">60East recommends using the <code class="docutils literal"><span class="pre">tcps</span></code> transport type for SSL
connections for clarity. However, AMPS uses SSL connections for
a <code class="docutils literal"><span class="pre">tcp</span></code> connection whenever a PrivateKey and Certificate are
provided for a Transport, regardless of whether the transport
<code class="docutils literal"><span class="pre">Type</span></code> is specified as <code class="docutils literal"><span class="pre">tcp</span></code> or <code class="docutils literal"><span class="pre">tcps</span></code>.</p>
<p class="last">AMPS clients require that the connection string use <code class="docutils literal"><span class="pre">tcps</span></code> for
SSL connections, even if the AMPS Transport configuration uses
<code class="docutils literal"><span class="pre">tcp</span></code>.</p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="unix-domain-sockets">
<h3>Unix domain sockets<a class="headerlink" href="#unix-domain-sockets" title="Permalink to this headline">¶</a></h3>
<p>AMPS provides transports that use unix domain sockets for applications
that run on the same system as the AMPS server and require extremely
low-latency messaging. Unix domain sockets are not supported by all AMPS
clients, since some programming environments do not support these
sockets.</p>
<p>With this transport type, many of the configuration settings that apply
to TCP/IP sockets are not relevant. Instead, the transport requires the
name of a file on the local filesystem as the location at which to
create the socket.</p>
</div>
</div>
<div class="section" id="replication-connections">
<h2>Replication Connections<a class="headerlink" href="#replication-connections" title="Permalink to this headline">¶</a></h2>
<p>To receive replicated messages from other AMPS instances, an AMPS
instance must have a transport configured as Type <code class="docutils literal"><span class="pre">amps-replication</span></code>.</p>
<p>Replication connections accept any message type, and can service
multiple upstream AMPS instances.</p>
<p>Replication connections are configured as part of an overall High
Availability plan. See <a class="reference internal" href="ha.html#common-ha-overview"><span class="std std-ref">High Availability</span></a> and the <a class="reference external" href="../../../configuration/html/index.html">AMPS Configuration Reference</a> for details.</p>
</div>
<div class="section" id="transport-filters">
<h2>Transport Filters<a class="headerlink" href="#transport-filters" title="Permalink to this headline">¶</a></h2>
<p>AMPS provides the ability for incoming commands to be modified, or <em>filtered</em>.</p>
<p>When one or more Transport Filters are specified, AMPS provides each incoming
command to those filters as soon as the header for the message is parsed. Each
filter can modify the message data or a subset of the headers, and can choose
to have AMPS stop processing the command (or can request that AMPS disconnect
the connection that submitted the command).</p>
<p>The filters for a <code class="docutils literal"><span class="pre">Transport</span></code>, if any, are defined in the configuration for
the transport.  When more than one filter is specified, AMPS runs each filter
in the order in which they appear in the configuration file.</p>
<p>Transport filters are implemented as extension modules. To create an extension
module, contact AMPS support for the server SDK.</p>
<p>AMPS loads the following transport filters by default.</p>
<table border="1" class="docutils">
<colgroup>
<col width="34%" />
<col width="66%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Module</th>
<th class="head">&#160;</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">amps-topic-translator</span></code></td>
<td><p class="first">Translates topic names on incoming commands.</p>
<p>This module requires one or more of the following
options:</p>
<p><code class="docutils literal"><span class="pre">Topic</span></code></p>
<p>Specifies the translation to use. This option
takes the following format:
<em>original*``:``*translated</em>.</p>
<p>The <em>original</em> parameter can be a literal topic
name or a PCRE regex. Any topic on any command that
matches that parameter will be converted to the
translated topic.</p>
<p>For example, to convert the topic <code class="docutils literal"><span class="pre">legacy</span></code> to the
topic <code class="docutils literal"><span class="pre">new</span></code>, you would specify the following
option:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">Options</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">Topic</span><span class="o">&gt;</span><span class="n">legacy</span><span class="p">:</span><span class="n">new</span><span class="o">&lt;/</span><span class="n">Topic</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">Options</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>To translate any topic beginning with
<code class="docutils literal"><span class="pre">/orders/northamerica</span></code> to  <code class="docutils literal"><span class="pre">NAorders</span></code>, you would
specify the following option:</p>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">Options</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">Topic</span><span class="o">&gt;^/</span><span class="n">orders</span><span class="o">/</span><span class="n">northamerica</span><span class="p">:</span><span class="n">NAorders</span><span class="o">&lt;/</span><span class="n">Topic</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">Options</span><span class="o">&gt;</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
<p><strong>Table 18.1:</strong> <em>Transport filters</em></p>
</div>
</div>


          </div>
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2017 60East Technologies, Inc.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.5.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
    </div>

    

    
  </body>
</html>